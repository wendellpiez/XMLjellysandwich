<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <title>Electronic Verse Engineer (EVE)</title>
      <meta charset="utf-8"/>
     <link href="https://fonts.googleapis.com/css?family=Alegreya|Roboto+Slab" rel="stylesheet"/> 
     <link rel="icon" href="../sando1-icon.svg"/>
     <style type="text/css">
      html body { font-family: Alegreya, serif }
      h1, h2, h3, h4, h5, h6 { font-family: 'Roboto Slab', sans-serif }
      a { color: inherit; text-decoration: none }
      a:hover { text-decoration: underline }
     </style>
     <style id="evefp-css"> <!-- css injection here --> </style>
     <script type="text/javascript"
              src="../lib/Saxon-JS-2.2/SaxonJS2.rt.js"><!-- parsers are so easily confused --></script>
     <!--
       don't need to preload since the only UI is in script
       <script> // loading with window so as to get interactivity bindings
        window.onload = function() {
          SaxonJS.transform({
            stylesheetLocation: "eve-saxonjs.sef.json",
            initialTemplate:    "load_verse_engineer"
          },"async");
          }   
        </script>-->
     <script xml:space="preserve">

// passes evetext into the Verse Engineer
function readEVE(evetext) {
  SaxonJS.transform({
    stylesheetLocation: "eve-read.sef.json",
    initialTemplate: "engineer-verse",
    stylesheetParams: {
      "evetext": evetext
    }
  },"async")
}

// OPENS A FILE, DROPS IT INTO AN ELEMENT VALUE (id=whereID) TO DISPLAY, AND CALLS THE VERSE ENGINEER
function dropFileText(fileSet,whereID) {
  fileSet.map(eachFile => {
    let where = document.getElementById(whereID)
    let frdr = new FileReader();
    frdr.onload = function () {
      where.value = frdr.result;
      readEVE(frdr.result)
    }
  frdr.readAsText(eachFile); } ) }
  
  
/* reads text out of an element, provides it to a download link and clicks it */
function offerDownload(fileName) {
  var contents = document.getElementById("tei-anthology").textContent;
  var f = new Blob([ contents ]);
  var a = document.createElement("a");
  a.href = URL.createObjectURL(f);
  a.download = fileName;
  a.click()
  }

</script>

   </head>
  
<!-- to do:

Anthologizer
  File load one or more EVEML files
    aggregate anthology (repeated loads is fine)
    display it
    edit in place? (or: have a 'remove' button)
    save it out as TEI

  -->
   <body>
      <div id="anthologizer-body">
        <div id="nav" style="padding-bottom: 1ex">
          <h3 style="float:right; margin: 0px" id="page-title" onclick="void(0)">Electronic Verse Engineer (EVE)</h3>
          <!--<button id="text_select">Text</button>
          <button id="tell_select">Tell</button>
          <button id="tweak_select">Hints</button>
          <button id="dir_select">Ideas</button>
          <button id="clear_select">Clear</button>-->
          
<!-- #dir_panel is populated by the XSLT -->
          
        </div>
        <details>
          <summary>Operating the Anthologizer</summary>
          <p>Load one or more EVE files. The Anthologizer builds an anthology for you.</p>
          <p>Copy it out or Save As TEI.</p>
        </details>
        <div class="panel" id="text_panel">
          <textarea  rows="28" cols="50" id="eve-entry">
          </textarea>
        </div>
        <div class="panel" id="display_panel">
          
        </div>
        
    </div>
      <div id="xmljellysandwich_footer">
        <p>The Anthologizer is part of the <i>Electronic Verse Engineer</i>, a project of Wendell Piez for <a href="http://pellucidliterature.org">Pellucid Literature</a> starting in 2021. <a href="https://github.com/wendellpiez/XMLjellysandwich">Find the source code on Github.</a></p>
      </div>
   </body>
</html>
